SELECT
	*
FROM work_volume_prediction
limit 100;

SELECT
	*
FROM tb4_volume_train
limit 100;

SELECT
	vehicle_model
	,COUNT(*)
FROM tb4_volume_train
GROUP BY
	vehicle_model
ORDER BY 1;

SELECT
	has_etc
	,COUNT(*)
FROM tb4_volume_train
GROUP BY
	has_etc
ORDER BY 1;

SELECT
	vehicle_type
	,CASE WHEN vehicle_type = '' THEN 1 ELSE 0 END
	,COUNT(*)
FROM tb4_volume_train
GROUP BY
	vehicle_type
	,CASE WHEN vehicle_type = '' THEN 1 ELSE 0 END
ORDER BY 1;

-- DROP TABLE tmp_volume_pred_train; 
CREATE TEMP TABLE tmp_volume_pred_train AS (
SELECT
	tollgate_id
	,time_window_start
	,direction
	,SUM(vehicle_model_0) AS sum_vehicle_model_0
	,SUM(vehicle_model_1) AS sum_vehicle_model_1
	,SUM(vehicle_model_2) AS sum_vehicle_model_2
	,SUM(vehicle_model_3) AS sum_vehicle_model_3
	,SUM(vehicle_model_4) AS sum_vehicle_model_4
	,SUM(vehicle_model_5) AS sum_vehicle_model_5
	,SUM(vehicle_model_6) AS sum_vehicle_model_6
	,SUM(vehicle_model_7) AS sum_vehicle_model_7
	,AVG(vehicle_model_0) AS avg_vehicle_model_0
	,AVG(vehicle_model_1) AS avg_vehicle_model_1
	,AVG(vehicle_model_2) AS avg_vehicle_model_2
	,AVG(vehicle_model_3) AS avg_vehicle_model_3
	,AVG(vehicle_model_4) AS avg_vehicle_model_4
	,AVG(vehicle_model_5) AS avg_vehicle_model_5
	,AVG(vehicle_model_6) AS avg_vehicle_model_6
	,AVG(vehicle_model_7) AS avg_vehicle_model_7
	,SUM(has_etc_0) AS sum_has_etc_0
	,SUM(has_etc_1) AS sum_has_etc_1
	,AVG(has_etc_0) AS avg_has_etc_0
	,AVG(has_etc_1) AS avg_has_etc_1
	,SUM(vehicle_type_NULL) AS sum_vehicle_type_NULL
	,SUM(vehicle_type_0) AS sum_vehicle_type_0
	,SUM(vehicle_type_1) AS sum_vehicle_type_1
	,AVG(vehicle_type_NULL) AS avg_vehicle_type_NULL
	,AVG(vehicle_type_0) AS avg_vehicle_type_0
	,AVG(vehicle_type_1) AS avg_vehicle_type_1
FROM (
	SELECT
		tollgate_id
		,make_timestamp(CAST(year AS INT), CAST(month AS INT), CAST(day AS INT), CAST(hour AS INT), CAST(minute AS INT), 0) AS time_window_start
		,direction
		,CASE WHEN vehicle_model = 0 THEN 1 ELSE 0 END AS vehicle_model_0
		,CASE WHEN vehicle_model = 1 THEN 1 ELSE 0 END AS vehicle_model_1
		,CASE WHEN vehicle_model = 2 THEN 1 ELSE 0 END AS vehicle_model_2
		,CASE WHEN vehicle_model = 3 THEN 1 ELSE 0 END AS vehicle_model_3
		,CASE WHEN vehicle_model = 4 THEN 1 ELSE 0 END AS vehicle_model_4
		,CASE WHEN vehicle_model = 5 THEN 1 ELSE 0 END AS vehicle_model_5
		,CASE WHEN vehicle_model = 6 THEN 1 ELSE 0 END AS vehicle_model_6
		,CASE WHEN vehicle_model = 7 THEN 1 ELSE 0 END AS vehicle_model_7
		,CASE WHEN has_etc = '0' THEN 1 ELSE 0 END AS has_etc_0
		,CASE WHEN has_etc = '1' THEN 1 ELSE 0 END AS has_etc_1
		,CASE WHEN vehicle_type = '' THEN 1 ELSE 0 END AS vehicle_type_NULL
		,CASE WHEN vehicle_type = '0' THEN 1 ELSE 0 END AS vehicle_type_0
		,CASE WHEN vehicle_type = '1' THEN 1 ELSE 0 END AS vehicle_type_1
	FROM (
		SELECT
			tollgate_id
			,direction
			,CAST(extract(year from time) AS INT) AS year
			,CAST(extract(month from time) AS INT) AS month
			,CAST(extract(day from time) AS INT) AS day
			,CAST(extract(hour from time) AS INT) AS hour
			,CAST(floor(extract(minute from time) / 20) * 20 AS INT) AS minute
			,vehicle_model
			,has_etc
			,vehicle_type
		FROM tb4_volume_train
	) AS A
) AS AA
GROUP BY
	tollgate_id
	,time_window_start
	,direction
);


SELECT
	*
FROM tmp_volume_pred_train
limit 100;

SELECT * FROM work_volume_prediction limit 100;

-- DROP TABLE work_volume_prediction2;
CREATE TABLE work_volume_prediction2 AS (
SELECT
	A.tollgate_id
	,A.time_window_start
	,A.time_window_end
	,A.time_window
	,A.direction
	,A.date
	,A.time
	,A.month
	,A.day
	,A.hour
	,A.minute
	,A.week
	,A.dow
	,B.sum_vehicle_model_0
	,B.sum_vehicle_model_1
	,B.sum_vehicle_model_2
	,B.sum_vehicle_model_3
	,B.sum_vehicle_model_4
	,B.sum_vehicle_model_5
	,B.sum_vehicle_model_6
	,B.sum_vehicle_model_7
	,B.avg_vehicle_model_0
	,B.avg_vehicle_model_1
	,B.avg_vehicle_model_2
	,B.avg_vehicle_model_3
	,B.avg_vehicle_model_4
	,B.avg_vehicle_model_5
	,B.avg_vehicle_model_6
	,B.avg_vehicle_model_7
	,B.sum_has_etc_0
	,B.sum_has_etc_1
	,B.avg_has_etc_0
	,B.avg_has_etc_1
	,B.sum_vehicle_type_null
	,B.sum_vehicle_type_0
	,B.sum_vehicle_type_1
	,B.avg_vehicle_type_null
	,B.avg_vehicle_type_0
	,B.avg_vehicle_type_1
	,A.volume
FROM work_volume_prediction AS A
LEFT JOIN tmp_volume_pred_train AS B ON A.tollgate_id = B.tollgate_id AND A.time_window_start = B.time_window_start AND A.direction = B.direction
);

-- DROP TABLE tmp_dm_volume_pred_train;
CREATE TEMP TABLE tmp_dm_volume_pred_train AS (
SELECT
	A.tollgate_id
	,A.time_window_start
	,A.time_window_end
	,A.time_window
	,A.direction
	,A.date
	,A.time
	,A.month
	,A.day
	,A.hour
	,A.minute
	,A.week
	,A.dow
	,A.volume AS target_window1
	,B.volume AS volume_bf02h00m
	,C.volume AS volume_bf01h40m
	,D.volume AS volume_bf01h20m
	,E.volume AS volume_bf01h00m
	,F.volume AS volume_bf00h40m
	,G.volume AS volume_bf00h20m
	,B.sum_vehicle_model_0 AS sum_vehicle_model_0_bf02h00m
	,B.sum_vehicle_model_1 AS sum_vehicle_model_1_bf02h00m
	,B.sum_vehicle_model_2 AS sum_vehicle_model_2_bf02h00m
	,B.sum_vehicle_model_3 AS sum_vehicle_model_3_bf02h00m
	,B.sum_vehicle_model_4 AS sum_vehicle_model_4_bf02h00m
	,B.sum_vehicle_model_5 AS sum_vehicle_model_5_bf02h00m
	,B.sum_vehicle_model_6 AS sum_vehicle_model_6_bf02h00m
	,B.sum_vehicle_model_7 AS sum_vehicle_model_7_bf02h00m
	,B.avg_vehicle_model_0 AS avg_vehicle_model_0_bf02h00m
	,B.avg_vehicle_model_1 AS avg_vehicle_model_1_bf02h00m
	,B.avg_vehicle_model_2 AS avg_vehicle_model_2_bf02h00m
	,B.avg_vehicle_model_3 AS avg_vehicle_model_3_bf02h00m
	,B.avg_vehicle_model_4 AS avg_vehicle_model_4_bf02h00m
	,B.avg_vehicle_model_5 AS avg_vehicle_model_5_bf02h00m
	,B.avg_vehicle_model_6 AS avg_vehicle_model_6_bf02h00m
	,B.avg_vehicle_model_7 AS avg_vehicle_model_7_bf02h00m
	,B.sum_has_etc_0 AS sum_has_etc_0_bf02h00m
	,B.sum_has_etc_1 AS sum_has_etc_1_bf02h00m
	,B.avg_has_etc_0 AS avg_has_etc_0_bf02h00m
	,B.avg_has_etc_1 AS avg_has_etc_1_bf02h00m
	,B.sum_vehicle_type_null AS sum_vehicle_type_null_bf02h00m
	,B.sum_vehicle_type_0 AS sum_vehicle_type_0_bf02h00m
	,B.sum_vehicle_type_1 AS sum_vehicle_type_1_bf02h00m
	,B.avg_vehicle_type_null AS avg_vehicle_type_null_bf02h00m
	,B.avg_vehicle_type_0 AS avg_vehicle_type_0_bf02h00m
	,B.avg_vehicle_type_1 AS avg_vehicle_type_1_bf02h00m
	,C.sum_vehicle_model_0 AS sum_vehicle_model_0_bf01h40m
	,C.sum_vehicle_model_1 AS sum_vehicle_model_1_bf01h40m
	,C.sum_vehicle_model_2 AS sum_vehicle_model_2_bf01h40m
	,C.sum_vehicle_model_3 AS sum_vehicle_model_3_bf01h40m
	,C.sum_vehicle_model_4 AS sum_vehicle_model_4_bf01h40m
	,C.sum_vehicle_model_5 AS sum_vehicle_model_5_bf01h40m
	,C.sum_vehicle_model_6 AS sum_vehicle_model_6_bf01h40m
	,C.sum_vehicle_model_7 AS sum_vehicle_model_7_bf01h40m
	,C.avg_vehicle_model_0 AS avg_vehicle_model_0_bf01h40m
	,C.avg_vehicle_model_1 AS avg_vehicle_model_1_bf01h40m
	,C.avg_vehicle_model_2 AS avg_vehicle_model_2_bf01h40m
	,C.avg_vehicle_model_3 AS avg_vehicle_model_3_bf01h40m
	,C.avg_vehicle_model_4 AS avg_vehicle_model_4_bf01h40m
	,C.avg_vehicle_model_5 AS avg_vehicle_model_5_bf01h40m
	,C.avg_vehicle_model_6 AS avg_vehicle_model_6_bf01h40m
	,C.avg_vehicle_model_7 AS avg_vehicle_model_7_bf01h40m
	,C.sum_has_etc_0 AS sum_has_etc_0_bf01h40m
	,C.sum_has_etc_1 AS sum_has_etc_1_bf01h40m
	,C.avg_has_etc_0 AS avg_has_etc_0_bf01h40m
	,C.avg_has_etc_1 AS avg_has_etc_1_bf01h40m
	,C.sum_vehicle_type_null AS sum_vehicle_type_null_bf01h40m
	,C.sum_vehicle_type_0 AS sum_vehicle_type_0_bf01h40m
	,C.sum_vehicle_type_1 AS sum_vehicle_type_1_bf01h40m
	,C.avg_vehicle_type_null AS avg_vehicle_type_null_bf01h40m
	,C.avg_vehicle_type_0 AS avg_vehicle_type_0_bf01h40m
	,C.avg_vehicle_type_1 AS avg_vehicle_type_1_bf01h40m
	,D.sum_vehicle_model_0 AS sum_vehicle_model_0_bf01h20m
	,D.sum_vehicle_model_1 AS sum_vehicle_model_1_bf01h20m
	,D.sum_vehicle_model_2 AS sum_vehicle_model_2_bf01h20m
	,D.sum_vehicle_model_3 AS sum_vehicle_model_3_bf01h20m
	,D.sum_vehicle_model_4 AS sum_vehicle_model_4_bf01h20m
	,D.sum_vehicle_model_5 AS sum_vehicle_model_5_bf01h20m
	,D.sum_vehicle_model_6 AS sum_vehicle_model_6_bf01h20m
	,D.sum_vehicle_model_7 AS sum_vehicle_model_7_bf01h20m
	,D.avg_vehicle_model_0 AS avg_vehicle_model_0_bf01h20m
	,D.avg_vehicle_model_1 AS avg_vehicle_model_1_bf01h20m
	,D.avg_vehicle_model_2 AS avg_vehicle_model_2_bf01h20m
	,D.avg_vehicle_model_3 AS avg_vehicle_model_3_bf01h20m
	,D.avg_vehicle_model_4 AS avg_vehicle_model_4_bf01h20m
	,D.avg_vehicle_model_5 AS avg_vehicle_model_5_bf01h20m
	,D.avg_vehicle_model_6 AS avg_vehicle_model_6_bf01h20m
	,D.avg_vehicle_model_7 AS avg_vehicle_model_7_bf01h20m
	,D.sum_has_etc_0 AS sum_has_etc_0_bf01h20m
	,D.sum_has_etc_1 AS sum_has_etc_1_bf01h20m
	,D.avg_has_etc_0 AS avg_has_etc_0_bf01h20m
	,D.avg_has_etc_1 AS avg_has_etc_1_bf01h20m
	,D.sum_vehicle_type_null AS sum_vehicle_type_null_bf01h20m
	,D.sum_vehicle_type_0 AS sum_vehicle_type_0_bf01h20m
	,D.sum_vehicle_type_1 AS sum_vehicle_type_1_bf01h20m
	,D.avg_vehicle_type_null AS avg_vehicle_type_null_bf01h20m
	,D.avg_vehicle_type_0 AS avg_vehicle_type_0_bf01h20m
	,D.avg_vehicle_type_1 AS avg_vehicle_type_1_bf01h20m
	,E.sum_vehicle_model_0 AS sum_vehicle_model_0_bf01h00m
	,E.sum_vehicle_model_1 AS sum_vehicle_model_1_bf01h00m
	,E.sum_vehicle_model_2 AS sum_vehicle_model_2_bf01h00m
	,E.sum_vehicle_model_3 AS sum_vehicle_model_3_bf01h00m
	,E.sum_vehicle_model_4 AS sum_vehicle_model_4_bf01h00m
	,E.sum_vehicle_model_5 AS sum_vehicle_model_5_bf01h00m
	,E.sum_vehicle_model_6 AS sum_vehicle_model_6_bf01h00m
	,E.sum_vehicle_model_7 AS sum_vehicle_model_7_bf01h00m
	,E.avg_vehicle_model_0 AS avg_vehicle_model_0_bf01h00m
	,E.avg_vehicle_model_1 AS avg_vehicle_model_1_bf01h00m
	,E.avg_vehicle_model_2 AS avg_vehicle_model_2_bf01h00m
	,E.avg_vehicle_model_3 AS avg_vehicle_model_3_bf01h00m
	,E.avg_vehicle_model_4 AS avg_vehicle_model_4_bf01h00m
	,E.avg_vehicle_model_5 AS avg_vehicle_model_5_bf01h00m
	,E.avg_vehicle_model_6 AS avg_vehicle_model_6_bf01h00m
	,E.avg_vehicle_model_7 AS avg_vehicle_model_7_bf01h00m
	,E.sum_has_etc_0 AS sum_has_etc_0_bf01h00m
	,E.sum_has_etc_1 AS sum_has_etc_1_bf01h00m
	,E.avg_has_etc_0 AS avg_has_etc_0_bf01h00m
	,E.avg_has_etc_1 AS avg_has_etc_1_bf01h00m
	,E.sum_vehicle_type_null AS sum_vehicle_type_null_bf01h00m
	,E.sum_vehicle_type_0 AS sum_vehicle_type_0_bf01h00m
	,E.sum_vehicle_type_1 AS sum_vehicle_type_1_bf01h00m
	,E.avg_vehicle_type_null AS avg_vehicle_type_null_bf01h00m
	,E.avg_vehicle_type_0 AS avg_vehicle_type_0_bf01h00m
	,E.avg_vehicle_type_1 AS avg_vehicle_type_1_bf01h00m
	,F.sum_vehicle_model_0 AS sum_vehicle_model_0_bf00h40m
	,F.sum_vehicle_model_1 AS sum_vehicle_model_1_bf00h40m
	,F.sum_vehicle_model_2 AS sum_vehicle_model_2_bf00h40m
	,F.sum_vehicle_model_3 AS sum_vehicle_model_3_bf00h40m
	,F.sum_vehicle_model_4 AS sum_vehicle_model_4_bf00h40m
	,F.sum_vehicle_model_5 AS sum_vehicle_model_5_bf00h40m
	,F.sum_vehicle_model_6 AS sum_vehicle_model_6_bf00h40m
	,F.sum_vehicle_model_7 AS sum_vehicle_model_7_bf00h40m
	,F.avg_vehicle_model_0 AS avg_vehicle_model_0_bf00h40m
	,F.avg_vehicle_model_1 AS avg_vehicle_model_1_bf00h40m
	,F.avg_vehicle_model_2 AS avg_vehicle_model_2_bf00h40m
	,F.avg_vehicle_model_3 AS avg_vehicle_model_3_bf00h40m
	,F.avg_vehicle_model_4 AS avg_vehicle_model_4_bf00h40m
	,F.avg_vehicle_model_5 AS avg_vehicle_model_5_bf00h40m
	,F.avg_vehicle_model_6 AS avg_vehicle_model_6_bf00h40m
	,F.avg_vehicle_model_7 AS avg_vehicle_model_7_bf00h40m
	,F.sum_has_etc_0 AS sum_has_etc_0_bf00h40m
	,F.sum_has_etc_1 AS sum_has_etc_1_bf00h40m
	,F.avg_has_etc_0 AS avg_has_etc_0_bf00h40m
	,F.avg_has_etc_1 AS avg_has_etc_1_bf00h40m
	,F.sum_vehicle_type_null AS sum_vehicle_type_null_bf00h40m
	,F.sum_vehicle_type_0 AS sum_vehicle_type_0_bf00h40m
	,F.sum_vehicle_type_1 AS sum_vehicle_type_1_bf00h40m
	,F.avg_vehicle_type_null AS avg_vehicle_type_null_bf00h40m
	,F.avg_vehicle_type_0 AS avg_vehicle_type_0_bf00h40m
	,F.avg_vehicle_type_1 AS avg_vehicle_type_1_bf00h40m
	,G.sum_vehicle_model_0 AS sum_vehicle_model_0_bf00h20m
	,G.sum_vehicle_model_1 AS sum_vehicle_model_1_bf00h20m
	,G.sum_vehicle_model_2 AS sum_vehicle_model_2_bf00h20m
	,G.sum_vehicle_model_3 AS sum_vehicle_model_3_bf00h20m
	,G.sum_vehicle_model_4 AS sum_vehicle_model_4_bf00h20m
	,G.sum_vehicle_model_5 AS sum_vehicle_model_5_bf00h20m
	,G.sum_vehicle_model_6 AS sum_vehicle_model_6_bf00h20m
	,G.sum_vehicle_model_7 AS sum_vehicle_model_7_bf00h20m
	,G.avg_vehicle_model_0 AS avg_vehicle_model_0_bf00h20m
	,G.avg_vehicle_model_1 AS avg_vehicle_model_1_bf00h20m
	,G.avg_vehicle_model_2 AS avg_vehicle_model_2_bf00h20m
	,G.avg_vehicle_model_3 AS avg_vehicle_model_3_bf00h20m
	,G.avg_vehicle_model_4 AS avg_vehicle_model_4_bf00h20m
	,G.avg_vehicle_model_5 AS avg_vehicle_model_5_bf00h20m
	,G.avg_vehicle_model_6 AS avg_vehicle_model_6_bf00h20m
	,G.avg_vehicle_model_7 AS avg_vehicle_model_7_bf00h20m
	,G.sum_has_etc_0 AS sum_has_etc_0_bf00h20m
	,G.sum_has_etc_1 AS sum_has_etc_1_bf00h20m
	,G.avg_has_etc_0 AS avg_has_etc_0_bf00h20m
	,G.avg_has_etc_1 AS avg_has_etc_1_bf00h20m
	,G.sum_vehicle_type_null AS sum_vehicle_type_null_bf00h20m
	,G.sum_vehicle_type_0 AS sum_vehicle_type_0_bf00h20m
	,G.sum_vehicle_type_1 AS sum_vehicle_type_1_bf00h20m
	,G.avg_vehicle_type_null AS avg_vehicle_type_null_bf00h20m
	,G.avg_vehicle_type_0 AS avg_vehicle_type_0_bf00h20m
	,G.avg_vehicle_type_1 AS avg_vehicle_type_1_bf00h20m
FROM work_volume_prediction2 AS A
LEFT JOIN work_volume_prediction2 AS B ON A.tollgate_id = B.tollgate_id AND A.direction = B.direction
	AND A.time_window_start = B.time_window_start + interval '2 hour'
LEFT JOIN work_volume_prediction2 AS C ON A.tollgate_id = C.tollgate_id AND A.direction = C.direction
	AND A.time_window_start = C.time_window_start + interval '1 hour' + interval '40 minute'
LEFT JOIN work_volume_prediction2 AS D ON A.tollgate_id = D.tollgate_id AND A.direction = D.direction
	AND A.time_window_start = D.time_window_start + interval '1 hour' + interval '20 minute'
LEFT JOIN work_volume_prediction2 AS E ON A.tollgate_id = E.tollgate_id AND A.direction = E.direction
	AND A.time_window_start = E.time_window_start + interval '1 hour'
LEFT JOIN work_volume_prediction2 AS F ON A.tollgate_id = F.tollgate_id AND A.direction = F.direction
	AND A.time_window_start = F.time_window_start + interval '40 minute'
LEFT JOIN work_volume_prediction2 AS G ON A.tollgate_id = G.tollgate_id AND A.direction = G.direction
	AND A.time_window_start = G.time_window_start + interval '20 minute'
);

SELECT
	*
FROM tmp_dm_volume_pred_train
limit 100;

-- DROP TABLE tmp_dm_volume_pred_train2;
CREATE TEMP TABLE tmp_dm_volume_pred_train2 AS (
SELECT
	A.*
	,B.target_window1 AS target_window2
	,C.target_window1 AS target_window3
	,D.target_window1 AS target_window4
	,E.target_window1 AS target_window5
	,F.target_window1 AS target_window6
FROM tmp_dm_volume_pred_train AS A
LEFT JOIN tmp_dm_volume_pred_train AS B ON A.tollgate_id = B.tollgate_id AND A.direction = B.direction
	AND A.time_window_start = B.time_window_start - interval '20 minute'
LEFT JOIN tmp_dm_volume_pred_train AS C ON A.tollgate_id = C.tollgate_id AND A.direction = C.direction
	AND A.time_window_start = C.time_window_start - interval '40 minute'
LEFT JOIN tmp_dm_volume_pred_train AS D ON A.tollgate_id = D.tollgate_id AND A.direction = D.direction
	AND A.time_window_start = D.time_window_start - interval '60 minute'
LEFT JOIN tmp_dm_volume_pred_train AS E ON A.tollgate_id = E.tollgate_id AND A.direction = E.direction
	AND A.time_window_start = E.time_window_start - interval '80 minute'
LEFT JOIN tmp_dm_volume_pred_train AS F ON A.tollgate_id = F.tollgate_id AND A.direction = F.direction
	AND A.time_window_start = F.time_window_start - interval '100 minute'
);

-- DROP TABLE work_dm_volume_pred_train_01;
CREATE TABLE work_dm_volume_pred_train_01 AS (
SELECT
	tollgate_id,time_window_start,time_window_end,time_window,direction,date,time,month,day,hour,minute,week,dow,volume_bf02h00m,volume_bf01h40m,volume_bf01h20m,volume_bf01h00m,volume_bf00h40m,volume_bf00h20m,sum_vehicle_model_0_bf02h00m,sum_vehicle_model_1_bf02h00m,sum_vehicle_model_2_bf02h00m,sum_vehicle_model_3_bf02h00m,sum_vehicle_model_4_bf02h00m,sum_vehicle_model_5_bf02h00m,sum_vehicle_model_6_bf02h00m,sum_vehicle_model_7_bf02h00m,avg_vehicle_model_0_bf02h00m,avg_vehicle_model_1_bf02h00m,avg_vehicle_model_2_bf02h00m,avg_vehicle_model_3_bf02h00m,avg_vehicle_model_4_bf02h00m,avg_vehicle_model_5_bf02h00m,avg_vehicle_model_6_bf02h00m,avg_vehicle_model_7_bf02h00m,sum_has_etc_0_bf02h00m,sum_has_etc_1_bf02h00m,avg_has_etc_0_bf02h00m,avg_has_etc_1_bf02h00m,sum_vehicle_type_null_bf02h00m,sum_vehicle_type_0_bf02h00m,sum_vehicle_type_1_bf02h00m,avg_vehicle_type_null_bf02h00m,avg_vehicle_type_0_bf02h00m,avg_vehicle_type_1_bf02h00m,sum_vehicle_model_0_bf01h40m,sum_vehicle_model_1_bf01h40m,sum_vehicle_model_2_bf01h40m,sum_vehicle_model_3_bf01h40m,sum_vehicle_model_4_bf01h40m,sum_vehicle_model_5_bf01h40m,sum_vehicle_model_6_bf01h40m,sum_vehicle_model_7_bf01h40m,avg_vehicle_model_0_bf01h40m,avg_vehicle_model_1_bf01h40m,avg_vehicle_model_2_bf01h40m,avg_vehicle_model_3_bf01h40m,avg_vehicle_model_4_bf01h40m,avg_vehicle_model_5_bf01h40m,avg_vehicle_model_6_bf01h40m,avg_vehicle_model_7_bf01h40m,sum_has_etc_0_bf01h40m,sum_has_etc_1_bf01h40m,avg_has_etc_0_bf01h40m,avg_has_etc_1_bf01h40m,sum_vehicle_type_null_bf01h40m,sum_vehicle_type_0_bf01h40m,sum_vehicle_type_1_bf01h40m,avg_vehicle_type_null_bf01h40m,avg_vehicle_type_0_bf01h40m,avg_vehicle_type_1_bf01h40m,sum_vehicle_model_0_bf01h20m,sum_vehicle_model_1_bf01h20m,sum_vehicle_model_2_bf01h20m,sum_vehicle_model_3_bf01h20m,sum_vehicle_model_4_bf01h20m,sum_vehicle_model_5_bf01h20m,sum_vehicle_model_6_bf01h20m,sum_vehicle_model_7_bf01h20m,avg_vehicle_model_0_bf01h20m,avg_vehicle_model_1_bf01h20m,avg_vehicle_model_2_bf01h20m,avg_vehicle_model_3_bf01h20m,avg_vehicle_model_4_bf01h20m,avg_vehicle_model_5_bf01h20m,avg_vehicle_model_6_bf01h20m,avg_vehicle_model_7_bf01h20m,sum_has_etc_0_bf01h20m,sum_has_etc_1_bf01h20m,avg_has_etc_0_bf01h20m,avg_has_etc_1_bf01h20m,sum_vehicle_type_null_bf01h20m,sum_vehicle_type_0_bf01h20m,sum_vehicle_type_1_bf01h20m,avg_vehicle_type_null_bf01h20m,avg_vehicle_type_0_bf01h20m,avg_vehicle_type_1_bf01h20m,sum_vehicle_model_0_bf01h00m,sum_vehicle_model_1_bf01h00m,sum_vehicle_model_2_bf01h00m,sum_vehicle_model_3_bf01h00m,sum_vehicle_model_4_bf01h00m,sum_vehicle_model_5_bf01h00m,sum_vehicle_model_6_bf01h00m,sum_vehicle_model_7_bf01h00m,avg_vehicle_model_0_bf01h00m,avg_vehicle_model_1_bf01h00m,avg_vehicle_model_2_bf01h00m,avg_vehicle_model_3_bf01h00m,avg_vehicle_model_4_bf01h00m,avg_vehicle_model_5_bf01h00m,avg_vehicle_model_6_bf01h00m,avg_vehicle_model_7_bf01h00m,sum_has_etc_0_bf01h00m,sum_has_etc_1_bf01h00m,avg_has_etc_0_bf01h00m,avg_has_etc_1_bf01h00m,sum_vehicle_type_null_bf01h00m,sum_vehicle_type_0_bf01h00m,sum_vehicle_type_1_bf01h00m,avg_vehicle_type_null_bf01h00m,avg_vehicle_type_0_bf01h00m,avg_vehicle_type_1_bf01h00m,sum_vehicle_model_0_bf00h40m,sum_vehicle_model_1_bf00h40m,sum_vehicle_model_2_bf00h40m,sum_vehicle_model_3_bf00h40m,sum_vehicle_model_4_bf00h40m,sum_vehicle_model_5_bf00h40m,sum_vehicle_model_6_bf00h40m,sum_vehicle_model_7_bf00h40m,avg_vehicle_model_0_bf00h40m,avg_vehicle_model_1_bf00h40m,avg_vehicle_model_2_bf00h40m,avg_vehicle_model_3_bf00h40m,avg_vehicle_model_4_bf00h40m,avg_vehicle_model_5_bf00h40m,avg_vehicle_model_6_bf00h40m,avg_vehicle_model_7_bf00h40m,sum_has_etc_0_bf00h40m,sum_has_etc_1_bf00h40m,avg_has_etc_0_bf00h40m,avg_has_etc_1_bf00h40m,sum_vehicle_type_null_bf00h40m,sum_vehicle_type_0_bf00h40m,sum_vehicle_type_1_bf00h40m,avg_vehicle_type_null_bf00h40m,avg_vehicle_type_0_bf00h40m,avg_vehicle_type_1_bf00h40m,sum_vehicle_model_0_bf00h20m,sum_vehicle_model_1_bf00h20m,sum_vehicle_model_2_bf00h20m,sum_vehicle_model_3_bf00h20m,sum_vehicle_model_4_bf00h20m,sum_vehicle_model_5_bf00h20m,sum_vehicle_model_6_bf00h20m,sum_vehicle_model_7_bf00h20m,avg_vehicle_model_0_bf00h20m,avg_vehicle_model_1_bf00h20m,avg_vehicle_model_2_bf00h20m,avg_vehicle_model_3_bf00h20m,avg_vehicle_model_4_bf00h20m,avg_vehicle_model_5_bf00h20m,avg_vehicle_model_6_bf00h20m,avg_vehicle_model_7_bf00h20m,sum_has_etc_0_bf00h20m,sum_has_etc_1_bf00h20m,avg_has_etc_0_bf00h20m,avg_has_etc_1_bf00h20m,sum_vehicle_type_null_bf00h20m,sum_vehicle_type_0_bf00h20m,sum_vehicle_type_1_bf00h20m,avg_vehicle_type_null_bf00h20m,avg_vehicle_type_0_bf00h20m,avg_vehicle_type_1_bf00h20m
	,'window1' AS window, target_window1 AS target
FROM tmp_dm_volume_pred_train2
UNION ALL
SELECT
	tollgate_id,time_window_start,time_window_end,time_window,direction,date,time,month,day,hour,minute,week,dow,volume_bf02h00m,volume_bf01h40m,volume_bf01h20m,volume_bf01h00m,volume_bf00h40m,volume_bf00h20m,sum_vehicle_model_0_bf02h00m,sum_vehicle_model_1_bf02h00m,sum_vehicle_model_2_bf02h00m,sum_vehicle_model_3_bf02h00m,sum_vehicle_model_4_bf02h00m,sum_vehicle_model_5_bf02h00m,sum_vehicle_model_6_bf02h00m,sum_vehicle_model_7_bf02h00m,avg_vehicle_model_0_bf02h00m,avg_vehicle_model_1_bf02h00m,avg_vehicle_model_2_bf02h00m,avg_vehicle_model_3_bf02h00m,avg_vehicle_model_4_bf02h00m,avg_vehicle_model_5_bf02h00m,avg_vehicle_model_6_bf02h00m,avg_vehicle_model_7_bf02h00m,sum_has_etc_0_bf02h00m,sum_has_etc_1_bf02h00m,avg_has_etc_0_bf02h00m,avg_has_etc_1_bf02h00m,sum_vehicle_type_null_bf02h00m,sum_vehicle_type_0_bf02h00m,sum_vehicle_type_1_bf02h00m,avg_vehicle_type_null_bf02h00m,avg_vehicle_type_0_bf02h00m,avg_vehicle_type_1_bf02h00m,sum_vehicle_model_0_bf01h40m,sum_vehicle_model_1_bf01h40m,sum_vehicle_model_2_bf01h40m,sum_vehicle_model_3_bf01h40m,sum_vehicle_model_4_bf01h40m,sum_vehicle_model_5_bf01h40m,sum_vehicle_model_6_bf01h40m,sum_vehicle_model_7_bf01h40m,avg_vehicle_model_0_bf01h40m,avg_vehicle_model_1_bf01h40m,avg_vehicle_model_2_bf01h40m,avg_vehicle_model_3_bf01h40m,avg_vehicle_model_4_bf01h40m,avg_vehicle_model_5_bf01h40m,avg_vehicle_model_6_bf01h40m,avg_vehicle_model_7_bf01h40m,sum_has_etc_0_bf01h40m,sum_has_etc_1_bf01h40m,avg_has_etc_0_bf01h40m,avg_has_etc_1_bf01h40m,sum_vehicle_type_null_bf01h40m,sum_vehicle_type_0_bf01h40m,sum_vehicle_type_1_bf01h40m,avg_vehicle_type_null_bf01h40m,avg_vehicle_type_0_bf01h40m,avg_vehicle_type_1_bf01h40m,sum_vehicle_model_0_bf01h20m,sum_vehicle_model_1_bf01h20m,sum_vehicle_model_2_bf01h20m,sum_vehicle_model_3_bf01h20m,sum_vehicle_model_4_bf01h20m,sum_vehicle_model_5_bf01h20m,sum_vehicle_model_6_bf01h20m,sum_vehicle_model_7_bf01h20m,avg_vehicle_model_0_bf01h20m,avg_vehicle_model_1_bf01h20m,avg_vehicle_model_2_bf01h20m,avg_vehicle_model_3_bf01h20m,avg_vehicle_model_4_bf01h20m,avg_vehicle_model_5_bf01h20m,avg_vehicle_model_6_bf01h20m,avg_vehicle_model_7_bf01h20m,sum_has_etc_0_bf01h20m,sum_has_etc_1_bf01h20m,avg_has_etc_0_bf01h20m,avg_has_etc_1_bf01h20m,sum_vehicle_type_null_bf01h20m,sum_vehicle_type_0_bf01h20m,sum_vehicle_type_1_bf01h20m,avg_vehicle_type_null_bf01h20m,avg_vehicle_type_0_bf01h20m,avg_vehicle_type_1_bf01h20m,sum_vehicle_model_0_bf01h00m,sum_vehicle_model_1_bf01h00m,sum_vehicle_model_2_bf01h00m,sum_vehicle_model_3_bf01h00m,sum_vehicle_model_4_bf01h00m,sum_vehicle_model_5_bf01h00m,sum_vehicle_model_6_bf01h00m,sum_vehicle_model_7_bf01h00m,avg_vehicle_model_0_bf01h00m,avg_vehicle_model_1_bf01h00m,avg_vehicle_model_2_bf01h00m,avg_vehicle_model_3_bf01h00m,avg_vehicle_model_4_bf01h00m,avg_vehicle_model_5_bf01h00m,avg_vehicle_model_6_bf01h00m,avg_vehicle_model_7_bf01h00m,sum_has_etc_0_bf01h00m,sum_has_etc_1_bf01h00m,avg_has_etc_0_bf01h00m,avg_has_etc_1_bf01h00m,sum_vehicle_type_null_bf01h00m,sum_vehicle_type_0_bf01h00m,sum_vehicle_type_1_bf01h00m,avg_vehicle_type_null_bf01h00m,avg_vehicle_type_0_bf01h00m,avg_vehicle_type_1_bf01h00m,sum_vehicle_model_0_bf00h40m,sum_vehicle_model_1_bf00h40m,sum_vehicle_model_2_bf00h40m,sum_vehicle_model_3_bf00h40m,sum_vehicle_model_4_bf00h40m,sum_vehicle_model_5_bf00h40m,sum_vehicle_model_6_bf00h40m,sum_vehicle_model_7_bf00h40m,avg_vehicle_model_0_bf00h40m,avg_vehicle_model_1_bf00h40m,avg_vehicle_model_2_bf00h40m,avg_vehicle_model_3_bf00h40m,avg_vehicle_model_4_bf00h40m,avg_vehicle_model_5_bf00h40m,avg_vehicle_model_6_bf00h40m,avg_vehicle_model_7_bf00h40m,sum_has_etc_0_bf00h40m,sum_has_etc_1_bf00h40m,avg_has_etc_0_bf00h40m,avg_has_etc_1_bf00h40m,sum_vehicle_type_null_bf00h40m,sum_vehicle_type_0_bf00h40m,sum_vehicle_type_1_bf00h40m,avg_vehicle_type_null_bf00h40m,avg_vehicle_type_0_bf00h40m,avg_vehicle_type_1_bf00h40m,sum_vehicle_model_0_bf00h20m,sum_vehicle_model_1_bf00h20m,sum_vehicle_model_2_bf00h20m,sum_vehicle_model_3_bf00h20m,sum_vehicle_model_4_bf00h20m,sum_vehicle_model_5_bf00h20m,sum_vehicle_model_6_bf00h20m,sum_vehicle_model_7_bf00h20m,avg_vehicle_model_0_bf00h20m,avg_vehicle_model_1_bf00h20m,avg_vehicle_model_2_bf00h20m,avg_vehicle_model_3_bf00h20m,avg_vehicle_model_4_bf00h20m,avg_vehicle_model_5_bf00h20m,avg_vehicle_model_6_bf00h20m,avg_vehicle_model_7_bf00h20m,sum_has_etc_0_bf00h20m,sum_has_etc_1_bf00h20m,avg_has_etc_0_bf00h20m,avg_has_etc_1_bf00h20m,sum_vehicle_type_null_bf00h20m,sum_vehicle_type_0_bf00h20m,sum_vehicle_type_1_bf00h20m,avg_vehicle_type_null_bf00h20m,avg_vehicle_type_0_bf00h20m,avg_vehicle_type_1_bf00h20m
	,'window2' AS window, target_window2 AS target
FROM tmp_dm_volume_pred_train2
UNION ALL
SELECT
	tollgate_id,time_window_start,time_window_end,time_window,direction,date,time,month,day,hour,minute,week,dow,volume_bf02h00m,volume_bf01h40m,volume_bf01h20m,volume_bf01h00m,volume_bf00h40m,volume_bf00h20m,sum_vehicle_model_0_bf02h00m,sum_vehicle_model_1_bf02h00m,sum_vehicle_model_2_bf02h00m,sum_vehicle_model_3_bf02h00m,sum_vehicle_model_4_bf02h00m,sum_vehicle_model_5_bf02h00m,sum_vehicle_model_6_bf02h00m,sum_vehicle_model_7_bf02h00m,avg_vehicle_model_0_bf02h00m,avg_vehicle_model_1_bf02h00m,avg_vehicle_model_2_bf02h00m,avg_vehicle_model_3_bf02h00m,avg_vehicle_model_4_bf02h00m,avg_vehicle_model_5_bf02h00m,avg_vehicle_model_6_bf02h00m,avg_vehicle_model_7_bf02h00m,sum_has_etc_0_bf02h00m,sum_has_etc_1_bf02h00m,avg_has_etc_0_bf02h00m,avg_has_etc_1_bf02h00m,sum_vehicle_type_null_bf02h00m,sum_vehicle_type_0_bf02h00m,sum_vehicle_type_1_bf02h00m,avg_vehicle_type_null_bf02h00m,avg_vehicle_type_0_bf02h00m,avg_vehicle_type_1_bf02h00m,sum_vehicle_model_0_bf01h40m,sum_vehicle_model_1_bf01h40m,sum_vehicle_model_2_bf01h40m,sum_vehicle_model_3_bf01h40m,sum_vehicle_model_4_bf01h40m,sum_vehicle_model_5_bf01h40m,sum_vehicle_model_6_bf01h40m,sum_vehicle_model_7_bf01h40m,avg_vehicle_model_0_bf01h40m,avg_vehicle_model_1_bf01h40m,avg_vehicle_model_2_bf01h40m,avg_vehicle_model_3_bf01h40m,avg_vehicle_model_4_bf01h40m,avg_vehicle_model_5_bf01h40m,avg_vehicle_model_6_bf01h40m,avg_vehicle_model_7_bf01h40m,sum_has_etc_0_bf01h40m,sum_has_etc_1_bf01h40m,avg_has_etc_0_bf01h40m,avg_has_etc_1_bf01h40m,sum_vehicle_type_null_bf01h40m,sum_vehicle_type_0_bf01h40m,sum_vehicle_type_1_bf01h40m,avg_vehicle_type_null_bf01h40m,avg_vehicle_type_0_bf01h40m,avg_vehicle_type_1_bf01h40m,sum_vehicle_model_0_bf01h20m,sum_vehicle_model_1_bf01h20m,sum_vehicle_model_2_bf01h20m,sum_vehicle_model_3_bf01h20m,sum_vehicle_model_4_bf01h20m,sum_vehicle_model_5_bf01h20m,sum_vehicle_model_6_bf01h20m,sum_vehicle_model_7_bf01h20m,avg_vehicle_model_0_bf01h20m,avg_vehicle_model_1_bf01h20m,avg_vehicle_model_2_bf01h20m,avg_vehicle_model_3_bf01h20m,avg_vehicle_model_4_bf01h20m,avg_vehicle_model_5_bf01h20m,avg_vehicle_model_6_bf01h20m,avg_vehicle_model_7_bf01h20m,sum_has_etc_0_bf01h20m,sum_has_etc_1_bf01h20m,avg_has_etc_0_bf01h20m,avg_has_etc_1_bf01h20m,sum_vehicle_type_null_bf01h20m,sum_vehicle_type_0_bf01h20m,sum_vehicle_type_1_bf01h20m,avg_vehicle_type_null_bf01h20m,avg_vehicle_type_0_bf01h20m,avg_vehicle_type_1_bf01h20m,sum_vehicle_model_0_bf01h00m,sum_vehicle_model_1_bf01h00m,sum_vehicle_model_2_bf01h00m,sum_vehicle_model_3_bf01h00m,sum_vehicle_model_4_bf01h00m,sum_vehicle_model_5_bf01h00m,sum_vehicle_model_6_bf01h00m,sum_vehicle_model_7_bf01h00m,avg_vehicle_model_0_bf01h00m,avg_vehicle_model_1_bf01h00m,avg_vehicle_model_2_bf01h00m,avg_vehicle_model_3_bf01h00m,avg_vehicle_model_4_bf01h00m,avg_vehicle_model_5_bf01h00m,avg_vehicle_model_6_bf01h00m,avg_vehicle_model_7_bf01h00m,sum_has_etc_0_bf01h00m,sum_has_etc_1_bf01h00m,avg_has_etc_0_bf01h00m,avg_has_etc_1_bf01h00m,sum_vehicle_type_null_bf01h00m,sum_vehicle_type_0_bf01h00m,sum_vehicle_type_1_bf01h00m,avg_vehicle_type_null_bf01h00m,avg_vehicle_type_0_bf01h00m,avg_vehicle_type_1_bf01h00m,sum_vehicle_model_0_bf00h40m,sum_vehicle_model_1_bf00h40m,sum_vehicle_model_2_bf00h40m,sum_vehicle_model_3_bf00h40m,sum_vehicle_model_4_bf00h40m,sum_vehicle_model_5_bf00h40m,sum_vehicle_model_6_bf00h40m,sum_vehicle_model_7_bf00h40m,avg_vehicle_model_0_bf00h40m,avg_vehicle_model_1_bf00h40m,avg_vehicle_model_2_bf00h40m,avg_vehicle_model_3_bf00h40m,avg_vehicle_model_4_bf00h40m,avg_vehicle_model_5_bf00h40m,avg_vehicle_model_6_bf00h40m,avg_vehicle_model_7_bf00h40m,sum_has_etc_0_bf00h40m,sum_has_etc_1_bf00h40m,avg_has_etc_0_bf00h40m,avg_has_etc_1_bf00h40m,sum_vehicle_type_null_bf00h40m,sum_vehicle_type_0_bf00h40m,sum_vehicle_type_1_bf00h40m,avg_vehicle_type_null_bf00h40m,avg_vehicle_type_0_bf00h40m,avg_vehicle_type_1_bf00h40m,sum_vehicle_model_0_bf00h20m,sum_vehicle_model_1_bf00h20m,sum_vehicle_model_2_bf00h20m,sum_vehicle_model_3_bf00h20m,sum_vehicle_model_4_bf00h20m,sum_vehicle_model_5_bf00h20m,sum_vehicle_model_6_bf00h20m,sum_vehicle_model_7_bf00h20m,avg_vehicle_model_0_bf00h20m,avg_vehicle_model_1_bf00h20m,avg_vehicle_model_2_bf00h20m,avg_vehicle_model_3_bf00h20m,avg_vehicle_model_4_bf00h20m,avg_vehicle_model_5_bf00h20m,avg_vehicle_model_6_bf00h20m,avg_vehicle_model_7_bf00h20m,sum_has_etc_0_bf00h20m,sum_has_etc_1_bf00h20m,avg_has_etc_0_bf00h20m,avg_has_etc_1_bf00h20m,sum_vehicle_type_null_bf00h20m,sum_vehicle_type_0_bf00h20m,sum_vehicle_type_1_bf00h20m,avg_vehicle_type_null_bf00h20m,avg_vehicle_type_0_bf00h20m,avg_vehicle_type_1_bf00h20m
	,'window3' AS window, target_window3 AS target
FROM tmp_dm_volume_pred_train2
UNION ALL
SELECT
	tollgate_id,time_window_start,time_window_end,time_window,direction,date,time,month,day,hour,minute,week,dow,volume_bf02h00m,volume_bf01h40m,volume_bf01h20m,volume_bf01h00m,volume_bf00h40m,volume_bf00h20m,sum_vehicle_model_0_bf02h00m,sum_vehicle_model_1_bf02h00m,sum_vehicle_model_2_bf02h00m,sum_vehicle_model_3_bf02h00m,sum_vehicle_model_4_bf02h00m,sum_vehicle_model_5_bf02h00m,sum_vehicle_model_6_bf02h00m,sum_vehicle_model_7_bf02h00m,avg_vehicle_model_0_bf02h00m,avg_vehicle_model_1_bf02h00m,avg_vehicle_model_2_bf02h00m,avg_vehicle_model_3_bf02h00m,avg_vehicle_model_4_bf02h00m,avg_vehicle_model_5_bf02h00m,avg_vehicle_model_6_bf02h00m,avg_vehicle_model_7_bf02h00m,sum_has_etc_0_bf02h00m,sum_has_etc_1_bf02h00m,avg_has_etc_0_bf02h00m,avg_has_etc_1_bf02h00m,sum_vehicle_type_null_bf02h00m,sum_vehicle_type_0_bf02h00m,sum_vehicle_type_1_bf02h00m,avg_vehicle_type_null_bf02h00m,avg_vehicle_type_0_bf02h00m,avg_vehicle_type_1_bf02h00m,sum_vehicle_model_0_bf01h40m,sum_vehicle_model_1_bf01h40m,sum_vehicle_model_2_bf01h40m,sum_vehicle_model_3_bf01h40m,sum_vehicle_model_4_bf01h40m,sum_vehicle_model_5_bf01h40m,sum_vehicle_model_6_bf01h40m,sum_vehicle_model_7_bf01h40m,avg_vehicle_model_0_bf01h40m,avg_vehicle_model_1_bf01h40m,avg_vehicle_model_2_bf01h40m,avg_vehicle_model_3_bf01h40m,avg_vehicle_model_4_bf01h40m,avg_vehicle_model_5_bf01h40m,avg_vehicle_model_6_bf01h40m,avg_vehicle_model_7_bf01h40m,sum_has_etc_0_bf01h40m,sum_has_etc_1_bf01h40m,avg_has_etc_0_bf01h40m,avg_has_etc_1_bf01h40m,sum_vehicle_type_null_bf01h40m,sum_vehicle_type_0_bf01h40m,sum_vehicle_type_1_bf01h40m,avg_vehicle_type_null_bf01h40m,avg_vehicle_type_0_bf01h40m,avg_vehicle_type_1_bf01h40m,sum_vehicle_model_0_bf01h20m,sum_vehicle_model_1_bf01h20m,sum_vehicle_model_2_bf01h20m,sum_vehicle_model_3_bf01h20m,sum_vehicle_model_4_bf01h20m,sum_vehicle_model_5_bf01h20m,sum_vehicle_model_6_bf01h20m,sum_vehicle_model_7_bf01h20m,avg_vehicle_model_0_bf01h20m,avg_vehicle_model_1_bf01h20m,avg_vehicle_model_2_bf01h20m,avg_vehicle_model_3_bf01h20m,avg_vehicle_model_4_bf01h20m,avg_vehicle_model_5_bf01h20m,avg_vehicle_model_6_bf01h20m,avg_vehicle_model_7_bf01h20m,sum_has_etc_0_bf01h20m,sum_has_etc_1_bf01h20m,avg_has_etc_0_bf01h20m,avg_has_etc_1_bf01h20m,sum_vehicle_type_null_bf01h20m,sum_vehicle_type_0_bf01h20m,sum_vehicle_type_1_bf01h20m,avg_vehicle_type_null_bf01h20m,avg_vehicle_type_0_bf01h20m,avg_vehicle_type_1_bf01h20m,sum_vehicle_model_0_bf01h00m,sum_vehicle_model_1_bf01h00m,sum_vehicle_model_2_bf01h00m,sum_vehicle_model_3_bf01h00m,sum_vehicle_model_4_bf01h00m,sum_vehicle_model_5_bf01h00m,sum_vehicle_model_6_bf01h00m,sum_vehicle_model_7_bf01h00m,avg_vehicle_model_0_bf01h00m,avg_vehicle_model_1_bf01h00m,avg_vehicle_model_2_bf01h00m,avg_vehicle_model_3_bf01h00m,avg_vehicle_model_4_bf01h00m,avg_vehicle_model_5_bf01h00m,avg_vehicle_model_6_bf01h00m,avg_vehicle_model_7_bf01h00m,sum_has_etc_0_bf01h00m,sum_has_etc_1_bf01h00m,avg_has_etc_0_bf01h00m,avg_has_etc_1_bf01h00m,sum_vehicle_type_null_bf01h00m,sum_vehicle_type_0_bf01h00m,sum_vehicle_type_1_bf01h00m,avg_vehicle_type_null_bf01h00m,avg_vehicle_type_0_bf01h00m,avg_vehicle_type_1_bf01h00m,sum_vehicle_model_0_bf00h40m,sum_vehicle_model_1_bf00h40m,sum_vehicle_model_2_bf00h40m,sum_vehicle_model_3_bf00h40m,sum_vehicle_model_4_bf00h40m,sum_vehicle_model_5_bf00h40m,sum_vehicle_model_6_bf00h40m,sum_vehicle_model_7_bf00h40m,avg_vehicle_model_0_bf00h40m,avg_vehicle_model_1_bf00h40m,avg_vehicle_model_2_bf00h40m,avg_vehicle_model_3_bf00h40m,avg_vehicle_model_4_bf00h40m,avg_vehicle_model_5_bf00h40m,avg_vehicle_model_6_bf00h40m,avg_vehicle_model_7_bf00h40m,sum_has_etc_0_bf00h40m,sum_has_etc_1_bf00h40m,avg_has_etc_0_bf00h40m,avg_has_etc_1_bf00h40m,sum_vehicle_type_null_bf00h40m,sum_vehicle_type_0_bf00h40m,sum_vehicle_type_1_bf00h40m,avg_vehicle_type_null_bf00h40m,avg_vehicle_type_0_bf00h40m,avg_vehicle_type_1_bf00h40m,sum_vehicle_model_0_bf00h20m,sum_vehicle_model_1_bf00h20m,sum_vehicle_model_2_bf00h20m,sum_vehicle_model_3_bf00h20m,sum_vehicle_model_4_bf00h20m,sum_vehicle_model_5_bf00h20m,sum_vehicle_model_6_bf00h20m,sum_vehicle_model_7_bf00h20m,avg_vehicle_model_0_bf00h20m,avg_vehicle_model_1_bf00h20m,avg_vehicle_model_2_bf00h20m,avg_vehicle_model_3_bf00h20m,avg_vehicle_model_4_bf00h20m,avg_vehicle_model_5_bf00h20m,avg_vehicle_model_6_bf00h20m,avg_vehicle_model_7_bf00h20m,sum_has_etc_0_bf00h20m,sum_has_etc_1_bf00h20m,avg_has_etc_0_bf00h20m,avg_has_etc_1_bf00h20m,sum_vehicle_type_null_bf00h20m,sum_vehicle_type_0_bf00h20m,sum_vehicle_type_1_bf00h20m,avg_vehicle_type_null_bf00h20m,avg_vehicle_type_0_bf00h20m,avg_vehicle_type_1_bf00h20m
	,'window4' AS window, target_window4 AS target
FROM tmp_dm_volume_pred_train2
UNION ALL
SELECT
	tollgate_id,time_window_start,time_window_end,time_window,direction,date,time,month,day,hour,minute,week,dow,volume_bf02h00m,volume_bf01h40m,volume_bf01h20m,volume_bf01h00m,volume_bf00h40m,volume_bf00h20m,sum_vehicle_model_0_bf02h00m,sum_vehicle_model_1_bf02h00m,sum_vehicle_model_2_bf02h00m,sum_vehicle_model_3_bf02h00m,sum_vehicle_model_4_bf02h00m,sum_vehicle_model_5_bf02h00m,sum_vehicle_model_6_bf02h00m,sum_vehicle_model_7_bf02h00m,avg_vehicle_model_0_bf02h00m,avg_vehicle_model_1_bf02h00m,avg_vehicle_model_2_bf02h00m,avg_vehicle_model_3_bf02h00m,avg_vehicle_model_4_bf02h00m,avg_vehicle_model_5_bf02h00m,avg_vehicle_model_6_bf02h00m,avg_vehicle_model_7_bf02h00m,sum_has_etc_0_bf02h00m,sum_has_etc_1_bf02h00m,avg_has_etc_0_bf02h00m,avg_has_etc_1_bf02h00m,sum_vehicle_type_null_bf02h00m,sum_vehicle_type_0_bf02h00m,sum_vehicle_type_1_bf02h00m,avg_vehicle_type_null_bf02h00m,avg_vehicle_type_0_bf02h00m,avg_vehicle_type_1_bf02h00m,sum_vehicle_model_0_bf01h40m,sum_vehicle_model_1_bf01h40m,sum_vehicle_model_2_bf01h40m,sum_vehicle_model_3_bf01h40m,sum_vehicle_model_4_bf01h40m,sum_vehicle_model_5_bf01h40m,sum_vehicle_model_6_bf01h40m,sum_vehicle_model_7_bf01h40m,avg_vehicle_model_0_bf01h40m,avg_vehicle_model_1_bf01h40m,avg_vehicle_model_2_bf01h40m,avg_vehicle_model_3_bf01h40m,avg_vehicle_model_4_bf01h40m,avg_vehicle_model_5_bf01h40m,avg_vehicle_model_6_bf01h40m,avg_vehicle_model_7_bf01h40m,sum_has_etc_0_bf01h40m,sum_has_etc_1_bf01h40m,avg_has_etc_0_bf01h40m,avg_has_etc_1_bf01h40m,sum_vehicle_type_null_bf01h40m,sum_vehicle_type_0_bf01h40m,sum_vehicle_type_1_bf01h40m,avg_vehicle_type_null_bf01h40m,avg_vehicle_type_0_bf01h40m,avg_vehicle_type_1_bf01h40m,sum_vehicle_model_0_bf01h20m,sum_vehicle_model_1_bf01h20m,sum_vehicle_model_2_bf01h20m,sum_vehicle_model_3_bf01h20m,sum_vehicle_model_4_bf01h20m,sum_vehicle_model_5_bf01h20m,sum_vehicle_model_6_bf01h20m,sum_vehicle_model_7_bf01h20m,avg_vehicle_model_0_bf01h20m,avg_vehicle_model_1_bf01h20m,avg_vehicle_model_2_bf01h20m,avg_vehicle_model_3_bf01h20m,avg_vehicle_model_4_bf01h20m,avg_vehicle_model_5_bf01h20m,avg_vehicle_model_6_bf01h20m,avg_vehicle_model_7_bf01h20m,sum_has_etc_0_bf01h20m,sum_has_etc_1_bf01h20m,avg_has_etc_0_bf01h20m,avg_has_etc_1_bf01h20m,sum_vehicle_type_null_bf01h20m,sum_vehicle_type_0_bf01h20m,sum_vehicle_type_1_bf01h20m,avg_vehicle_type_null_bf01h20m,avg_vehicle_type_0_bf01h20m,avg_vehicle_type_1_bf01h20m,sum_vehicle_model_0_bf01h00m,sum_vehicle_model_1_bf01h00m,sum_vehicle_model_2_bf01h00m,sum_vehicle_model_3_bf01h00m,sum_vehicle_model_4_bf01h00m,sum_vehicle_model_5_bf01h00m,sum_vehicle_model_6_bf01h00m,sum_vehicle_model_7_bf01h00m,avg_vehicle_model_0_bf01h00m,avg_vehicle_model_1_bf01h00m,avg_vehicle_model_2_bf01h00m,avg_vehicle_model_3_bf01h00m,avg_vehicle_model_4_bf01h00m,avg_vehicle_model_5_bf01h00m,avg_vehicle_model_6_bf01h00m,avg_vehicle_model_7_bf01h00m,sum_has_etc_0_bf01h00m,sum_has_etc_1_bf01h00m,avg_has_etc_0_bf01h00m,avg_has_etc_1_bf01h00m,sum_vehicle_type_null_bf01h00m,sum_vehicle_type_0_bf01h00m,sum_vehicle_type_1_bf01h00m,avg_vehicle_type_null_bf01h00m,avg_vehicle_type_0_bf01h00m,avg_vehicle_type_1_bf01h00m,sum_vehicle_model_0_bf00h40m,sum_vehicle_model_1_bf00h40m,sum_vehicle_model_2_bf00h40m,sum_vehicle_model_3_bf00h40m,sum_vehicle_model_4_bf00h40m,sum_vehicle_model_5_bf00h40m,sum_vehicle_model_6_bf00h40m,sum_vehicle_model_7_bf00h40m,avg_vehicle_model_0_bf00h40m,avg_vehicle_model_1_bf00h40m,avg_vehicle_model_2_bf00h40m,avg_vehicle_model_3_bf00h40m,avg_vehicle_model_4_bf00h40m,avg_vehicle_model_5_bf00h40m,avg_vehicle_model_6_bf00h40m,avg_vehicle_model_7_bf00h40m,sum_has_etc_0_bf00h40m,sum_has_etc_1_bf00h40m,avg_has_etc_0_bf00h40m,avg_has_etc_1_bf00h40m,sum_vehicle_type_null_bf00h40m,sum_vehicle_type_0_bf00h40m,sum_vehicle_type_1_bf00h40m,avg_vehicle_type_null_bf00h40m,avg_vehicle_type_0_bf00h40m,avg_vehicle_type_1_bf00h40m,sum_vehicle_model_0_bf00h20m,sum_vehicle_model_1_bf00h20m,sum_vehicle_model_2_bf00h20m,sum_vehicle_model_3_bf00h20m,sum_vehicle_model_4_bf00h20m,sum_vehicle_model_5_bf00h20m,sum_vehicle_model_6_bf00h20m,sum_vehicle_model_7_bf00h20m,avg_vehicle_model_0_bf00h20m,avg_vehicle_model_1_bf00h20m,avg_vehicle_model_2_bf00h20m,avg_vehicle_model_3_bf00h20m,avg_vehicle_model_4_bf00h20m,avg_vehicle_model_5_bf00h20m,avg_vehicle_model_6_bf00h20m,avg_vehicle_model_7_bf00h20m,sum_has_etc_0_bf00h20m,sum_has_etc_1_bf00h20m,avg_has_etc_0_bf00h20m,avg_has_etc_1_bf00h20m,sum_vehicle_type_null_bf00h20m,sum_vehicle_type_0_bf00h20m,sum_vehicle_type_1_bf00h20m,avg_vehicle_type_null_bf00h20m,avg_vehicle_type_0_bf00h20m,avg_vehicle_type_1_bf00h20m
	,'window5' AS window, target_window5 AS target
FROM tmp_dm_volume_pred_train2
UNION ALL
SELECT
	tollgate_id,time_window_start,time_window_end,time_window,direction,date,time,month,day,hour,minute,week,dow,volume_bf02h00m,volume_bf01h40m,volume_bf01h20m,volume_bf01h00m,volume_bf00h40m,volume_bf00h20m,sum_vehicle_model_0_bf02h00m,sum_vehicle_model_1_bf02h00m,sum_vehicle_model_2_bf02h00m,sum_vehicle_model_3_bf02h00m,sum_vehicle_model_4_bf02h00m,sum_vehicle_model_5_bf02h00m,sum_vehicle_model_6_bf02h00m,sum_vehicle_model_7_bf02h00m,avg_vehicle_model_0_bf02h00m,avg_vehicle_model_1_bf02h00m,avg_vehicle_model_2_bf02h00m,avg_vehicle_model_3_bf02h00m,avg_vehicle_model_4_bf02h00m,avg_vehicle_model_5_bf02h00m,avg_vehicle_model_6_bf02h00m,avg_vehicle_model_7_bf02h00m,sum_has_etc_0_bf02h00m,sum_has_etc_1_bf02h00m,avg_has_etc_0_bf02h00m,avg_has_etc_1_bf02h00m,sum_vehicle_type_null_bf02h00m,sum_vehicle_type_0_bf02h00m,sum_vehicle_type_1_bf02h00m,avg_vehicle_type_null_bf02h00m,avg_vehicle_type_0_bf02h00m,avg_vehicle_type_1_bf02h00m,sum_vehicle_model_0_bf01h40m,sum_vehicle_model_1_bf01h40m,sum_vehicle_model_2_bf01h40m,sum_vehicle_model_3_bf01h40m,sum_vehicle_model_4_bf01h40m,sum_vehicle_model_5_bf01h40m,sum_vehicle_model_6_bf01h40m,sum_vehicle_model_7_bf01h40m,avg_vehicle_model_0_bf01h40m,avg_vehicle_model_1_bf01h40m,avg_vehicle_model_2_bf01h40m,avg_vehicle_model_3_bf01h40m,avg_vehicle_model_4_bf01h40m,avg_vehicle_model_5_bf01h40m,avg_vehicle_model_6_bf01h40m,avg_vehicle_model_7_bf01h40m,sum_has_etc_0_bf01h40m,sum_has_etc_1_bf01h40m,avg_has_etc_0_bf01h40m,avg_has_etc_1_bf01h40m,sum_vehicle_type_null_bf01h40m,sum_vehicle_type_0_bf01h40m,sum_vehicle_type_1_bf01h40m,avg_vehicle_type_null_bf01h40m,avg_vehicle_type_0_bf01h40m,avg_vehicle_type_1_bf01h40m,sum_vehicle_model_0_bf01h20m,sum_vehicle_model_1_bf01h20m,sum_vehicle_model_2_bf01h20m,sum_vehicle_model_3_bf01h20m,sum_vehicle_model_4_bf01h20m,sum_vehicle_model_5_bf01h20m,sum_vehicle_model_6_bf01h20m,sum_vehicle_model_7_bf01h20m,avg_vehicle_model_0_bf01h20m,avg_vehicle_model_1_bf01h20m,avg_vehicle_model_2_bf01h20m,avg_vehicle_model_3_bf01h20m,avg_vehicle_model_4_bf01h20m,avg_vehicle_model_5_bf01h20m,avg_vehicle_model_6_bf01h20m,avg_vehicle_model_7_bf01h20m,sum_has_etc_0_bf01h20m,sum_has_etc_1_bf01h20m,avg_has_etc_0_bf01h20m,avg_has_etc_1_bf01h20m,sum_vehicle_type_null_bf01h20m,sum_vehicle_type_0_bf01h20m,sum_vehicle_type_1_bf01h20m,avg_vehicle_type_null_bf01h20m,avg_vehicle_type_0_bf01h20m,avg_vehicle_type_1_bf01h20m,sum_vehicle_model_0_bf01h00m,sum_vehicle_model_1_bf01h00m,sum_vehicle_model_2_bf01h00m,sum_vehicle_model_3_bf01h00m,sum_vehicle_model_4_bf01h00m,sum_vehicle_model_5_bf01h00m,sum_vehicle_model_6_bf01h00m,sum_vehicle_model_7_bf01h00m,avg_vehicle_model_0_bf01h00m,avg_vehicle_model_1_bf01h00m,avg_vehicle_model_2_bf01h00m,avg_vehicle_model_3_bf01h00m,avg_vehicle_model_4_bf01h00m,avg_vehicle_model_5_bf01h00m,avg_vehicle_model_6_bf01h00m,avg_vehicle_model_7_bf01h00m,sum_has_etc_0_bf01h00m,sum_has_etc_1_bf01h00m,avg_has_etc_0_bf01h00m,avg_has_etc_1_bf01h00m,sum_vehicle_type_null_bf01h00m,sum_vehicle_type_0_bf01h00m,sum_vehicle_type_1_bf01h00m,avg_vehicle_type_null_bf01h00m,avg_vehicle_type_0_bf01h00m,avg_vehicle_type_1_bf01h00m,sum_vehicle_model_0_bf00h40m,sum_vehicle_model_1_bf00h40m,sum_vehicle_model_2_bf00h40m,sum_vehicle_model_3_bf00h40m,sum_vehicle_model_4_bf00h40m,sum_vehicle_model_5_bf00h40m,sum_vehicle_model_6_bf00h40m,sum_vehicle_model_7_bf00h40m,avg_vehicle_model_0_bf00h40m,avg_vehicle_model_1_bf00h40m,avg_vehicle_model_2_bf00h40m,avg_vehicle_model_3_bf00h40m,avg_vehicle_model_4_bf00h40m,avg_vehicle_model_5_bf00h40m,avg_vehicle_model_6_bf00h40m,avg_vehicle_model_7_bf00h40m,sum_has_etc_0_bf00h40m,sum_has_etc_1_bf00h40m,avg_has_etc_0_bf00h40m,avg_has_etc_1_bf00h40m,sum_vehicle_type_null_bf00h40m,sum_vehicle_type_0_bf00h40m,sum_vehicle_type_1_bf00h40m,avg_vehicle_type_null_bf00h40m,avg_vehicle_type_0_bf00h40m,avg_vehicle_type_1_bf00h40m,sum_vehicle_model_0_bf00h20m,sum_vehicle_model_1_bf00h20m,sum_vehicle_model_2_bf00h20m,sum_vehicle_model_3_bf00h20m,sum_vehicle_model_4_bf00h20m,sum_vehicle_model_5_bf00h20m,sum_vehicle_model_6_bf00h20m,sum_vehicle_model_7_bf00h20m,avg_vehicle_model_0_bf00h20m,avg_vehicle_model_1_bf00h20m,avg_vehicle_model_2_bf00h20m,avg_vehicle_model_3_bf00h20m,avg_vehicle_model_4_bf00h20m,avg_vehicle_model_5_bf00h20m,avg_vehicle_model_6_bf00h20m,avg_vehicle_model_7_bf00h20m,sum_has_etc_0_bf00h20m,sum_has_etc_1_bf00h20m,avg_has_etc_0_bf00h20m,avg_has_etc_1_bf00h20m,sum_vehicle_type_null_bf00h20m,sum_vehicle_type_0_bf00h20m,sum_vehicle_type_1_bf00h20m,avg_vehicle_type_null_bf00h20m,avg_vehicle_type_0_bf00h20m,avg_vehicle_type_1_bf00h20m
	,'window6' AS window, target_window6 AS target
FROM tmp_dm_volume_pred_train2
);

SELECT * FROM work_dm_volume_pred_train_01;

SELECT
	*
FROM work_dm_volume_pred_train_01
WHERE date = '2016-09-19'
	AND (hour BETWEEN 8 AND 9)
	AND "window" = 'window1'
	AND tollgate_id = '1'
	AND direction = '0'
;

SELECT
	

